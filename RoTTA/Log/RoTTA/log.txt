2025-08-19 13:49:50,667 TTA-ML INFO: Namespace(config_file='configs/adapter/rotta.yaml', opts=[])
2025-08-19 13:49:50,667 TTA-ML INFO: Loaded configuration file: configs/adapter/rotta.yaml
2025-08-19 13:49:50,667 TTA-ML INFO: Running with config:
ADAPTER:
  NAME: rotta_multilabels
  RoTTA:
    ALPHA: 0.05
    LAMBDA_T: 1.0
    LAMBDA_U: 1.0
    MEMORY_SIZE: 64
    NU: 0.001
    UPDATE_FREQUENCY: 64
BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar10
  NUM_CLASS: -1
  NUM_EX: 10000
  SEVERITY: [5, 4, 3, 2, 1]
  SOURCE: 
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATASET:
  ADAPTATION_MODE: corruption
  BASE_DOMAIN:
    CSV: validate_reordered.csv
    IMAGE_DIR: images
    PATH: /home/ngoto/Working/Data/MixData/nih_14_structured
  CHEXPERT_CSV: validate.csv
  CHEXPERT_IMAGE_DIR: valid
  CHEXPERT_PATH: /Users/admin/Working/Data/MixData/nih_14_structured
  LABELS_LIST: ['Atelectasis', 'Cardiomegaly', 'Consolidation', 'Pleural Effusion', 'Pneumothorax']
  NAME: CXR
  NIH14_CSV: validate_reordered.csv
  NIH14_IMAGE_DIR: images
  NIH14_PATH: /home/ngoto/Working/Data/MixData/nih_14_structured
  PADCHEST_CSV: refined_padchest_labels_reordered.csv
  PADCHEST_IMAGE_DIR: images-224
  PADCHEST_PATH: /home/ngoto/Working/Data/MixData/PadChestPruning
  SEVERITY: 0.0
  TEST_CORRUPTIONS: ['elastic_transform']
  TEST_DOMAINS: ['nih14']
  VINDR_CSV: validate_reordered.csv
  VINDR_IMAGE_DIR: images
  VINDR_PATH: /home/ngoto/Working/Data/MixData/vinbigdata_structured
DATA_DIR: ./datasets
DEBUG: 0
DESC: 
INPUT:
  INTERPOLATION: bilinear
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 2.225]
  SIZE: (224, 224)
  TRANSFORMS: ('normalize',)
LOADER:
  NUM_WORKS: 4
  SAMPLER:
    GAMMA: 0.1
    TYPE: temporal
LOG_DEST: log.txt
LOG_TIME: 
MODEL:
  ARCH: resnet18
  EPISODIC: False
  NUM_CLASSES: 5
  PROJECTION:
    EMB_DIM: 2048
    FEA_DIM: 128
    HEAD: linear
OPTIM:
  AP: 0.72
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  MT: 0.999
  NESTEROV: True
  RST: 0.01
  STEPS: 1
  WD: 0.0
OUTPUT_DIR: Log/RoTTA
SEED: 42
TEST:
  BATCH_SIZE: 64
  NUM_EPOCHS: 1
2025-08-19 13:49:53,449 TTA-ML INFO: Model and TTA adapter initialized.
2025-08-19 13:49:53,449 TTA-ML INFO: =========== Starting TTA Epoch 1/1 ===========
2025-08-19 13:49:53,449 TTA-ML INFO: Running in 'corruption' adaptation mode for this epoch.
2025-08-19 13:54:32,643 TTA-ML INFO: --- Epoch 1 Final Results ---
- Mean AUC: 0.7500
- Atelectasis      : 0.7002
- Cardiomegaly     : 0.8513
- Consolidation    : 0.6139
- Pleural Effusion : 0.7771
- Pneumothorax     : 0.8074
2025-08-19 13:54:32,672 TTA-ML INFO: New best AUC found: 0.7500. Saving model state for epoch 1.
2025-08-19 13:54:32,672 TTA-ML INFO: =========== TTA Finished ===========
2025-08-19 13:54:32,672 TTA-ML INFO: Best Mean AUC achieved across 1 epochs: 0.7500
2025-08-19 13:54:32,794 TTA-ML INFO: Best model state saved to Log/RoTTA/best_tta_model.pth
2025-08-19 15:34:57,470 TTA-ML INFO: Namespace(config_file='configs/adapter/rotta.yaml', opts=[])
2025-08-19 15:34:57,470 TTA-ML INFO: Loaded configuration file: configs/adapter/rotta.yaml
2025-08-19 15:34:57,470 TTA-ML INFO: Running with config:
ADAPTER:
  NAME: rotta_multilabels
  RoTTA:
    ALPHA: 0.05
    LAMBDA_T: 1.0
    LAMBDA_U: 1.0
    MEMORY_SIZE: 64
    NU: 0.001
    UPDATE_FREQUENCY: 64
BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar10
  NUM_CLASS: -1
  NUM_EX: 10000
  SEVERITY: [5, 4, 3, 2, 1]
  SOURCE: 
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATASET:
  ADAPTATION_MODE: corruption
  BASE_DOMAIN:
    CSV: validate_reordered.csv
    IMAGE_DIR: images
    PATH: /home/ngoto/Working/Data/MixData/nih_14_structured
  CHEXPERT_CSV: validate.csv
  CHEXPERT_IMAGE_DIR: valid
  CHEXPERT_PATH: /Users/admin/Working/Data/MixData/nih_14_structured
  LABELS_LIST: ['Atelectasis', 'Cardiomegaly', 'Consolidation', 'Pleural Effusion', 'Pneumothorax']
  NAME: CXR
  NIH14_CSV: validate_reordered.csv
  NIH14_IMAGE_DIR: images
  NIH14_PATH: /home/ngoto/Working/Data/MixData/nih_14_structured
  PADCHEST_CSV: refined_padchest_labels_reordered.csv
  PADCHEST_IMAGE_DIR: images-224
  PADCHEST_PATH: /home/ngoto/Working/Data/MixData/PadChestPruning
  SEVERITY: 5.0
  TEST_CORRUPTIONS: ['elastic_transform', 'contrast', 'snow', 'pixelate', 'defocus_blur', 'motion_blur', 'zoom_blur', 'brightness', 'gaussian_noise', 'jpeg_compression', 'glass_blur', 'shot_noise', 'fog', 'frost', 'impulse_noise']
  TEST_DOMAINS: ['nih14']
  VINDR_CSV: validate_reordered.csv
  VINDR_IMAGE_DIR: images
  VINDR_PATH: /home/ngoto/Working/Data/MixData/vinbigdata_structured
DATA_DIR: ./datasets
DEBUG: 0
DESC: 
INPUT:
  INTERPOLATION: bilinear
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 2.225]
  SIZE: (224, 224)
  TRANSFORMS: ('normalize',)
LOADER:
  NUM_WORKS: 4
  SAMPLER:
    GAMMA: 0.1
    TYPE: temporal
LOG_DEST: log.txt
LOG_TIME: 
MODEL:
  ARCH: resnet18
  EPISODIC: False
  NUM_CLASSES: 5
  PROJECTION:
    EMB_DIM: 2048
    FEA_DIM: 128
    HEAD: linear
OPTIM:
  AP: 0.72
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  MT: 0.999
  NESTEROV: True
  RST: 0.01
  STEPS: 1
  WD: 0.0
OUTPUT_DIR: Log/RoTTA
SEED: 42
TEST:
  BATCH_SIZE: 64
  NUM_EPOCHS: 1
2025-08-19 15:35:00,395 TTA-ML INFO: Model and TTA adapter initialized.
2025-08-19 15:35:00,396 TTA-ML INFO: =========== Starting TTA Epoch 1/1 ===========
2025-08-19 15:35:00,396 TTA-ML INFO: Running in 'corruption' adaptation mode for this epoch.
2025-08-19 17:21:33,101 TTA-ML INFO: --- Epoch 1 Final Results ---
- Mean AUC: 0.6785
- Atelectasis      : 0.6680
- Cardiomegaly     : 0.7929
- Consolidation    : 0.5472
- Pleural Effusion : 0.6870
- Pneumothorax     : 0.6974
2025-08-19 17:21:33,128 TTA-ML INFO: New best AUC found: 0.6785. Saving model state for epoch 1.
2025-08-19 17:21:33,128 TTA-ML INFO: =========== TTA Finished ===========
2025-08-19 17:21:33,128 TTA-ML INFO: Best Mean AUC achieved across 1 epochs: 0.6785
2025-08-19 20:54:44,806 TTA-ML INFO: Namespace(config_file='configs/adapter/rotta.yaml', opts=[])
2025-08-19 20:54:44,807 TTA-ML INFO: Loaded configuration file: configs/adapter/rotta.yaml
2025-08-19 20:54:44,807 TTA-ML INFO: Running with config:
ADAPTER:
  NAME: rotta_multilabels
  RoTTA:
    ALPHA: 0.05
    LAMBDA_T: 1.0
    LAMBDA_U: 1.0
    MEMORY_SIZE: 64
    NU: 0.001
    UPDATE_FREQUENCY: 64
BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar10
  NUM_CLASS: -1
  NUM_EX: 10000
  SEVERITY: [5, 4, 3, 2, 1]
  SOURCE: 
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATASET:
  ADAPTATION_MODE: corruption
  BASE_DOMAIN:
    CSV: validate_reordered.csv
    IMAGE_DIR: images
    PATH: /home/ngoto/Working/Data/MixData/nih_14_structured
  CHEXPERT_CSV: validate.csv
  CHEXPERT_IMAGE_DIR: valid
  CHEXPERT_PATH: /Users/admin/Working/Data/MixData/nih_14_structured
  LABELS_LIST: ['Atelectasis', 'Cardiomegaly', 'Consolidation', 'Pleural Effusion', 'Pneumothorax']
  NAME: CXR
  NIH14_CSV: validate_reordered.csv
  NIH14_IMAGE_DIR: images
  NIH14_PATH: /home/ngoto/Working/Data/MixData/nih_14_structured
  PADCHEST_CSV: refined_padchest_labels_reordered.csv
  PADCHEST_IMAGE_DIR: images-224
  PADCHEST_PATH: /home/ngoto/Working/Data/MixData/PadChestPruning
  SEVERITY: 5.0
  TEST_CORRUPTIONS: ['elastic_transform', 'contrast', 'snow', 'pixelate', 'defocus_blur', 'motion_blur', 'zoom_blur', 'brightness', 'gaussian_noise', 'jpeg_compression', 'glass_blur', 'shot_noise', 'fog', 'frost', 'impulse_noise']
  TEST_DOMAINS: ['nih14']
  VINDR_CSV: validate_reordered.csv
  VINDR_IMAGE_DIR: images
  VINDR_PATH: /home/ngoto/Working/Data/MixData/vinbigdata_structured
DATA_DIR: ./datasets
DEBUG: 0
DESC: 
INPUT:
  INTERPOLATION: bilinear
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 2.225]
  SIZE: (224, 224)
  TRANSFORMS: ('normalize',)
LOADER:
  NUM_WORKS: 4
  SAMPLER:
    GAMMA: 0.1
    TYPE: temporal
LOG_DEST: log.txt
LOG_TIME: 
MODEL:
  ARCH: resnet18
  EPISODIC: False
  NUM_CLASSES: 5
  PROJECTION:
    EMB_DIM: 2048
    FEA_DIM: 128
    HEAD: linear
OPTIM:
  AP: 0.72
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  MT: 0.999
  NESTEROV: True
  RST: 0.01
  STEPS: 1
  WD: 0.0
OUTPUT_DIR: Log/RoTTA
SEED: 42
TEST:
  BATCH_SIZE: 64
  NUM_EPOCHS: 1
2025-08-19 20:54:47,566 TTA-ML INFO: Model and TTA adapter initialized.
2025-08-19 20:54:47,566 TTA-ML INFO: =========== Starting TTA Epoch 1/1 ===========
2025-08-19 20:54:47,566 TTA-ML INFO: Running in 'corruption' adaptation mode for this epoch.
2025-08-19 20:56:14,407 TTA-ML INFO: Namespace(config_file='configs/adapter/rotta.yaml', opts=[])
2025-08-19 20:56:14,407 TTA-ML INFO: Loaded configuration file: configs/adapter/rotta.yaml
2025-08-19 20:56:14,407 TTA-ML INFO: Running with config:
ADAPTER:
  NAME: rotta_multilabels
  RoTTA:
    ALPHA: 0.05
    LAMBDA_T: 1.0
    LAMBDA_U: 1.0
    MEMORY_SIZE: 64
    NU: 0.001
    UPDATE_FREQUENCY: 64
BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar10
  NUM_CLASS: -1
  NUM_EX: 10000
  SEVERITY: [5, 4, 3, 2, 1]
  SOURCE: 
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATASET:
  ADAPTATION_MODE: corruption
  BASE_DOMAIN:
    CSV: validate_reordered.csv
    IMAGE_DIR: images
    PATH: /home/ngoto/Working/Data/MixData/nih_14_structured
  CHEXPERT_CSV: validate.csv
  CHEXPERT_IMAGE_DIR: valid
  CHEXPERT_PATH: /Users/admin/Working/Data/MixData/nih_14_structured
  LABELS_LIST: ['Atelectasis', 'Cardiomegaly', 'Consolidation', 'Pleural Effusion', 'Pneumothorax']
  NAME: CXR
  NIH14_CSV: validate_reordered.csv
  NIH14_IMAGE_DIR: images
  NIH14_PATH: /home/ngoto/Working/Data/MixData/nih_14_structured
  PADCHEST_CSV: refined_padchest_labels_reordered.csv
  PADCHEST_IMAGE_DIR: images-224
  PADCHEST_PATH: /home/ngoto/Working/Data/MixData/PadChestPruning
  SEVERITY: 5.0
  TEST_CORRUPTIONS: ['elastic_transform', 'contrast', 'snow', 'pixelate', 'defocus_blur', 'motion_blur', 'zoom_blur', 'brightness', 'gaussian_noise', 'jpeg_compression', 'glass_blur', 'shot_noise', 'fog', 'frost', 'impulse_noise']
  TEST_DOMAINS: ['nih14']
  VINDR_CSV: validate_reordered.csv
  VINDR_IMAGE_DIR: images
  VINDR_PATH: /home/ngoto/Working/Data/MixData/vinbigdata_structured
DATA_DIR: ./datasets
DEBUG: 0
DESC: 
INPUT:
  INTERPOLATION: bilinear
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 2.225]
  SIZE: (224, 224)
  TRANSFORMS: ('normalize',)
LOADER:
  NUM_WORKS: 4
  SAMPLER:
    GAMMA: 0.1
    TYPE: temporal
LOG_DEST: log.txt
LOG_TIME: 
MODEL:
  ARCH: resnet18
  EPISODIC: False
  NUM_CLASSES: 5
  PROJECTION:
    EMB_DIM: 2048
    FEA_DIM: 128
    HEAD: linear
OPTIM:
  AP: 0.72
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  MT: 0.999
  NESTEROV: True
  RST: 0.01
  STEPS: 1
  WD: 0.0
OUTPUT_DIR: Log/RoTTA
SEED: 42
TEST:
  BATCH_SIZE: 64
  NUM_EPOCHS: 1
2025-08-19 20:56:17,132 TTA-ML INFO: Model and TTA adapter initialized.
2025-08-19 20:56:17,133 TTA-ML INFO: =========== Starting TTA Epoch 1/1 ===========
2025-08-19 20:56:17,133 TTA-ML INFO: Running in 'corruption' adaptation mode for this epoch.
2025-08-19 20:56:35,213 TTA-ML INFO: Namespace(config_file='configs/adapter/rotta.yaml', opts=[])
2025-08-19 20:56:35,214 TTA-ML INFO: Loaded configuration file: configs/adapter/rotta.yaml
2025-08-19 20:56:35,214 TTA-ML INFO: Running with config:
ADAPTER:
  NAME: rotta_multilabels
  RoTTA:
    ALPHA: 0.05
    LAMBDA_T: 1.0
    LAMBDA_U: 1.0
    MEMORY_SIZE: 64
    NU: 0.001
    UPDATE_FREQUENCY: 64
BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar10
  NUM_CLASS: -1
  NUM_EX: 10000
  SEVERITY: [5, 4, 3, 2, 1]
  SOURCE: 
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATASET:
  ADAPTATION_MODE: corruption
  BASE_DOMAIN:
    CSV: validate_reordered.csv
    IMAGE_DIR: images
    PATH: /home/ngoto/Working/Data/MixData/nih_14_structured
  CHEXPERT_CSV: validate.csv
  CHEXPERT_IMAGE_DIR: valid
  CHEXPERT_PATH: /Users/admin/Working/Data/MixData/nih_14_structured
  LABELS_LIST: ['Atelectasis', 'Cardiomegaly', 'Consolidation', 'Pleural Effusion', 'Pneumothorax']
  NAME: CXR
  NIH14_CSV: validate_reordered.csv
  NIH14_IMAGE_DIR: images
  NIH14_PATH: /home/ngoto/Working/Data/MixData/nih_14_structured
  PADCHEST_CSV: refined_padchest_labels_reordered.csv
  PADCHEST_IMAGE_DIR: images-224
  PADCHEST_PATH: /home/ngoto/Working/Data/MixData/PadChestPruning
  SEVERITY: 5.0
  TEST_CORRUPTIONS: ['elastic_transform', 'contrast', 'snow', 'pixelate', 'defocus_blur', 'motion_blur', 'zoom_blur', 'brightness', 'gaussian_noise', 'jpeg_compression', 'glass_blur', 'shot_noise', 'fog', 'frost', 'impulse_noise']
  TEST_DOMAINS: ['nih14']
  VINDR_CSV: validate_reordered.csv
  VINDR_IMAGE_DIR: images
  VINDR_PATH: /home/ngoto/Working/Data/MixData/vinbigdata_structured
DATA_DIR: ./datasets
DEBUG: 0
DESC: 
INPUT:
  INTERPOLATION: bilinear
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 2.225]
  SIZE: (224, 224)
  TRANSFORMS: ('normalize',)
LOADER:
  NUM_WORKS: 4
  SAMPLER:
    GAMMA: 0.1
    TYPE: temporal
LOG_DEST: log.txt
LOG_TIME: 
MODEL:
  ARCH: resnet18
  EPISODIC: False
  NUM_CLASSES: 5
  PROJECTION:
    EMB_DIM: 2048
    FEA_DIM: 128
    HEAD: linear
OPTIM:
  AP: 0.72
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  MT: 0.999
  NESTEROV: True
  RST: 0.01
  STEPS: 1
  WD: 0.0
OUTPUT_DIR: Log/RoTTA
SEED: 42
TEST:
  BATCH_SIZE: 64
  NUM_EPOCHS: 1
2025-08-19 20:56:37,856 TTA-ML INFO: Model and TTA adapter initialized.
2025-08-19 20:56:37,856 TTA-ML INFO: =========== Starting TTA Epoch 1/1 ===========
2025-08-19 20:56:37,856 TTA-ML INFO: Running in 'corruption' adaptation mode for this epoch.
2025-08-19 20:57:58,125 TTA-ML INFO: Namespace(config_file='configs/adapter/rotta.yaml', opts=[])
2025-08-19 20:57:58,125 TTA-ML INFO: Loaded configuration file: configs/adapter/rotta.yaml
2025-08-19 20:57:58,125 TTA-ML INFO: Running with config:
ADAPTER:
  NAME: rotta_multilabels
  RoTTA:
    ALPHA: 0.05
    LAMBDA_T: 1.0
    LAMBDA_U: 1.0
    MEMORY_SIZE: 64
    NU: 0.001
    UPDATE_FREQUENCY: 64
BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar10
  NUM_CLASS: -1
  NUM_EX: 10000
  SEVERITY: [5, 4, 3, 2, 1]
  SOURCE: 
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATASET:
  ADAPTATION_MODE: corruption
  BASE_DOMAIN:
    CSV: validate_reordered.csv
    IMAGE_DIR: images
    PATH: /home/ngoto/Working/Data/MixData/nih_14_structured
  CHEXPERT_CSV: validate.csv
  CHEXPERT_IMAGE_DIR: valid
  CHEXPERT_PATH: /Users/admin/Working/Data/MixData/nih_14_structured
  LABELS_LIST: ['Atelectasis', 'Cardiomegaly', 'Consolidation', 'Pleural Effusion', 'Pneumothorax']
  NAME: CXR
  NIH14_CSV: validate_reordered.csv
  NIH14_IMAGE_DIR: images
  NIH14_PATH: /home/ngoto/Working/Data/MixData/nih_14_structured
  PADCHEST_CSV: refined_padchest_labels_reordered.csv
  PADCHEST_IMAGE_DIR: images-224
  PADCHEST_PATH: /home/ngoto/Working/Data/MixData/PadChestPruning
  SEVERITY: 0.0
  TEST_CORRUPTIONS: ['elastic_transform']
  TEST_DOMAINS: ['nih14']
  VINDR_CSV: validate_reordered.csv
  VINDR_IMAGE_DIR: images
  VINDR_PATH: /home/ngoto/Working/Data/MixData/vinbigdata_structured
DATA_DIR: ./datasets
DEBUG: 0
DESC: 
INPUT:
  INTERPOLATION: bilinear
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 2.225]
  SIZE: (224, 224)
  TRANSFORMS: ('normalize',)
LOADER:
  NUM_WORKS: 4
  SAMPLER:
    GAMMA: 0.1
    TYPE: temporal
LOG_DEST: log.txt
LOG_TIME: 
MODEL:
  ARCH: resnet18
  EPISODIC: False
  NUM_CLASSES: 5
  PROJECTION:
    EMB_DIM: 2048
    FEA_DIM: 128
    HEAD: linear
OPTIM:
  AP: 0.72
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  MT: 0.999
  NESTEROV: True
  RST: 0.01
  STEPS: 1
  WD: 0.0
OUTPUT_DIR: Log/RoTTA
SEED: 42
TEST:
  BATCH_SIZE: 64
  NUM_EPOCHS: 1
2025-08-19 20:58:00,848 TTA-ML INFO: Model and TTA adapter initialized.
2025-08-19 20:58:00,849 TTA-ML INFO: =========== Starting TTA Epoch 1/1 ===========
2025-08-19 20:58:00,849 TTA-ML INFO: Running in 'corruption' adaptation mode for this epoch.
2025-08-19 21:02:30,651 TTA-ML INFO: --- Epoch 1 Final Results ---
- Mean AUC: 0.7489
- Atelectasis      : 0.6992
- Cardiomegaly     : 0.8493
- Consolidation    : 0.6129
- Pleural Effusion : 0.7758
- Pneumothorax     : 0.8073
2025-08-19 21:02:30,678 TTA-ML INFO: New best AUC found: 0.7489. Saving model state for epoch 1.
2025-08-19 21:02:30,678 TTA-ML INFO: =========== TTA Finished ===========
2025-08-19 21:02:30,678 TTA-ML INFO: Best Mean AUC achieved across 1 epochs: 0.7489
2025-08-19 21:06:03,844 TTA-ML INFO: Namespace(config_file='configs/adapter/rotta.yaml', opts=[])
2025-08-19 21:06:03,844 TTA-ML INFO: Loaded configuration file: configs/adapter/rotta.yaml
2025-08-19 21:06:03,845 TTA-ML INFO: Running with config:
ADAPTER:
  NAME: rotta_multilabels
  RoTTA:
    ALPHA: 0.05
    LAMBDA_T: 1.0
    LAMBDA_U: 1.0
    MEMORY_SIZE: 64
    NU: 0.001
    UPDATE_FREQUENCY: 64
BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar10
  NUM_CLASS: -1
  NUM_EX: 10000
  SEVERITY: [5, 4, 3, 2, 1]
  SOURCE: 
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATASET:
  ADAPTATION_MODE: corruption
  BASE_DOMAIN:
    CSV: validate_reordered.csv
    IMAGE_DIR: images
    PATH: /home/ngoto/Working/Data/MixData/nih_14_structured
  CHEXPERT_CSV: validate.csv
  CHEXPERT_IMAGE_DIR: valid
  CHEXPERT_PATH: /Users/admin/Working/Data/MixData/nih_14_structured
  LABELS_LIST: ['Atelectasis', 'Cardiomegaly', 'Consolidation', 'Pleural Effusion', 'Pneumothorax']
  NAME: CXR
  NIH14_CSV: validate_reordered.csv
  NIH14_IMAGE_DIR: images
  NIH14_PATH: /home/ngoto/Working/Data/MixData/nih_14_structured
  PADCHEST_CSV: refined_padchest_labels_reordered.csv
  PADCHEST_IMAGE_DIR: images-224
  PADCHEST_PATH: /home/ngoto/Working/Data/MixData/PadChestPruning
  SEVERITY: 0.0
  TEST_CORRUPTIONS: ['elastic_transform', 'contrast', 'snow', 'pixelate', 'defocus_blur', 'motion_blur', 'zoom_blur', 'brightness', 'gaussian_noise', 'jpeg_compression', 'glass_blur', 'shot_noise', 'fog', 'frost', 'impulse_noise']
  TEST_DOMAINS: ['nih14']
  VINDR_CSV: validate_reordered.csv
  VINDR_IMAGE_DIR: images
  VINDR_PATH: /home/ngoto/Working/Data/MixData/vinbigdata_structured
DATA_DIR: ./datasets
DEBUG: 0
DESC: 
INPUT:
  INTERPOLATION: bilinear
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 2.225]
  SIZE: (224, 224)
  TRANSFORMS: ('normalize',)
LOADER:
  NUM_WORKS: 4
  SAMPLER:
    GAMMA: 0.1
    TYPE: temporal
LOG_DEST: log.txt
LOG_TIME: 
MODEL:
  ARCH: resnet18
  EPISODIC: False
  NUM_CLASSES: 5
  PROJECTION:
    EMB_DIM: 2048
    FEA_DIM: 128
    HEAD: linear
OPTIM:
  AP: 0.72
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  MT: 0.999
  NESTEROV: True
  RST: 0.01
  STEPS: 1
  WD: 0.0
OUTPUT_DIR: Log/RoTTA
SEED: 42
TEST:
  BATCH_SIZE: 64
  NUM_EPOCHS: 1
2025-08-19 21:06:06,566 TTA-ML INFO: Model and TTA adapter initialized.
2025-08-19 21:06:06,567 TTA-ML INFO: =========== Starting TTA Epoch 1/1 ===========
2025-08-19 21:06:06,567 TTA-ML INFO: Running in 'corruption' adaptation mode for this epoch.
2025-08-19 21:12:03,159 TTA-ML INFO: Namespace(config_file='configs/adapter/rotta.yaml', opts=[])
2025-08-19 21:12:03,159 TTA-ML INFO: Loaded configuration file: configs/adapter/rotta.yaml
2025-08-19 21:12:03,159 TTA-ML INFO: Running with config:
ADAPTER:
  NAME: rotta_multilabels
  RoTTA:
    ALPHA: 0.05
    LAMBDA_T: 1.0
    LAMBDA_U: 1.0
    MEMORY_SIZE: 64
    NU: 0.001
    UPDATE_FREQUENCY: 64
BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar10
  NUM_CLASS: -1
  NUM_EX: 10000
  SEVERITY: [5, 4, 3, 2, 1]
  SOURCE: 
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATASET:
  ADAPTATION_MODE: corruption
  BASE_DOMAIN:
    CSV: validate_reordered.csv
    IMAGE_DIR: images
    PATH: /home/ngoto/Working/Data/MixData/nih_14_structured
  CHEXPERT_CSV: validate.csv
  CHEXPERT_IMAGE_DIR: valid
  CHEXPERT_PATH: /Users/admin/Working/Data/MixData/nih_14_structured
  LABELS_LIST: ['Atelectasis', 'Cardiomegaly', 'Consolidation', 'Pleural Effusion', 'Pneumothorax']
  NAME: CXR
  NIH14_CSV: validate_reordered.csv
  NIH14_IMAGE_DIR: images
  NIH14_PATH: /home/ngoto/Working/Data/MixData/nih_14_structured
  PADCHEST_CSV: refined_padchest_labels_reordered.csv
  PADCHEST_IMAGE_DIR: images-224
  PADCHEST_PATH: /home/ngoto/Working/Data/MixData/PadChestPruning
  SEVERITY: 5.0
  TEST_CORRUPTIONS: ['elastic_transform', 'contrast', 'snow', 'pixelate', 'defocus_blur', 'motion_blur', 'zoom_blur', 'brightness', 'gaussian_noise', 'jpeg_compression', 'glass_blur', 'shot_noise', 'fog', 'frost', 'impulse_noise']
  TEST_DOMAINS: ['nih14']
  VINDR_CSV: validate_reordered.csv
  VINDR_IMAGE_DIR: images
  VINDR_PATH: /home/ngoto/Working/Data/MixData/vinbigdata_structured
DATA_DIR: ./datasets
DEBUG: 0
DESC: 
INPUT:
  INTERPOLATION: bilinear
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 2.225]
  SIZE: (224, 224)
  TRANSFORMS: ('normalize',)
LOADER:
  NUM_WORKS: 4
  SAMPLER:
    GAMMA: 0.1
    TYPE: temporal
LOG_DEST: log.txt
LOG_TIME: 
MODEL:
  ARCH: resnet18
  EPISODIC: False
  NUM_CLASSES: 5
  PROJECTION:
    EMB_DIM: 2048
    FEA_DIM: 128
    HEAD: linear
OPTIM:
  AP: 0.72
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  MT: 0.999
  NESTEROV: True
  RST: 0.01
  STEPS: 1
  WD: 0.0
OUTPUT_DIR: Log/RoTTA
SEED: 42
TEST:
  BATCH_SIZE: 64
  NUM_EPOCHS: 1
2025-08-19 21:12:05,792 TTA-ML INFO: Model and TTA adapter initialized.
2025-08-19 21:12:05,793 TTA-ML INFO: =========== Starting TTA Epoch 1/1 ===========
2025-08-19 21:12:05,793 TTA-ML INFO: Running in 'corruption' adaptation mode for this epoch.
2025-08-19 23:00:45,501 TTA-ML INFO: --- Epoch 1 Final Results ---
- Mean AUC: 0.6775
- Atelectasis      : 0.6684
- Cardiomegaly     : 0.7690
- Consolidation    : 0.5657
- Pleural Effusion : 0.6867
- Pneumothorax     : 0.6975
2025-08-19 23:00:45,531 TTA-ML INFO: New best AUC found: 0.6775. Saving model state for epoch 1.
2025-08-19 23:00:45,531 TTA-ML INFO: =========== TTA Finished ===========
2025-08-19 23:00:45,532 TTA-ML INFO: Best Mean AUC achieved across 1 epochs: 0.6775
2025-08-19 23:27:07,222 TTA-ML INFO: Namespace(config_file='configs/adapter/rotta.yaml', opts=[])
2025-08-19 23:27:07,222 TTA-ML INFO: Loaded configuration file: configs/adapter/rotta.yaml
2025-08-19 23:27:07,223 TTA-ML INFO: Running with config:
ADAPTER:
  NAME: rotta_multilabels
  RoTTA:
    ALPHA: 0.05
    LAMBDA_T: 1.0
    LAMBDA_U: 1.0
    MEMORY_SIZE: 64
    NU: 0.001
    UPDATE_FREQUENCY: 64
BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar10
  NUM_CLASS: -1
  NUM_EX: 10000
  SEVERITY: [5, 4, 3, 2, 1]
  SOURCE: 
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATASET:
  ADAPTATION_MODE: corruption
  BASE_DOMAIN:
    CSV: validate_reordered.csv
    IMAGE_DIR: images
    PATH: /home/ngoto/Working/Data/MixData/nih_14_structured
  CHEXPERT_CSV: validate.csv
  CHEXPERT_IMAGE_DIR: valid
  CHEXPERT_PATH: /Users/admin/Working/Data/MixData/nih_14_structured
  LABELS_LIST: ['Atelectasis', 'Cardiomegaly', 'Consolidation', 'Pleural Effusion', 'Pneumothorax']
  NAME: CXR
  NIH14_CSV: validate_reordered.csv
  NIH14_IMAGE_DIR: images
  NIH14_PATH: /home/ngoto/Working/Data/MixData/nih_14_structured
  PADCHEST_CSV: refined_padchest_labels_reordered.csv
  PADCHEST_IMAGE_DIR: images-224
  PADCHEST_PATH: /home/ngoto/Working/Data/MixData/PadChestPruning
  SEVERITY: 5.0
  TEST_CORRUPTIONS: ['elastic_transform', 'contrast', 'snow', 'pixelate', 'defocus_blur', 'motion_blur', 'zoom_blur', 'brightness', 'gaussian_noise', 'jpeg_compression', 'glass_blur', 'shot_noise', 'fog', 'frost', 'impulse_noise']
  TEST_DOMAINS: ['nih14']
  VINDR_CSV: validate_reordered.csv
  VINDR_IMAGE_DIR: images
  VINDR_PATH: /home/ngoto/Working/Data/MixData/vinbigdata_structured
DATA_DIR: ./datasets
DEBUG: 0
DESC: 
INPUT:
  INTERPOLATION: bilinear
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 2.225]
  SIZE: (224, 224)
  TRANSFORMS: ('normalize',)
LOADER:
  NUM_WORKS: 4
  SAMPLER:
    GAMMA: 0.1
    TYPE: temporal
LOG_DEST: log.txt
LOG_TIME: 
MODEL:
  ARCH: resnet18
  EPISODIC: False
  NUM_CLASSES: 5
  PROJECTION:
    EMB_DIM: 2048
    FEA_DIM: 128
    HEAD: linear
OPTIM:
  AP: 0.72
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  MT: 0.999
  NESTEROV: True
  RST: 0.01
  STEPS: 1
  WD: 0.0
OUTPUT_DIR: Log/RoTTA
SEED: 42
TEST:
  BATCH_SIZE: 64
  NUM_EPOCHS: 1
2025-08-19 23:27:09,963 TTA-ML INFO: Model and TTA adapter initialized.
2025-08-19 23:27:09,964 TTA-ML INFO: =========== Starting TTA Epoch 1/1 ===========
2025-08-19 23:27:09,964 TTA-ML INFO: Running in 'corruption' adaptation mode for this epoch.
2025-08-19 23:29:40,035 TTA-ML INFO: Namespace(config_file='configs/adapter/rotta.yaml', opts=[])
2025-08-19 23:29:40,035 TTA-ML INFO: Loaded configuration file: configs/adapter/rotta.yaml
2025-08-19 23:29:40,036 TTA-ML INFO: Running with config:
ADAPTER:
  NAME: rotta_multilabels
  RoTTA:
    ALPHA: 0.05
    LAMBDA_T: 1.0
    LAMBDA_U: 1.0
    MEMORY_SIZE: 64
    NU: 0.001
    UPDATE_FREQUENCY: 64
BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar10
  NUM_CLASS: -1
  NUM_EX: 10000
  SEVERITY: [5, 4, 3, 2, 1]
  SOURCE: 
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATASET:
  ADAPTATION_MODE: corruption
  BASE_DOMAIN:
    CSV: validate_reordered.csv
    IMAGE_DIR: images
    PATH: /home/ngoto/Working/Data/MixData/nih_14_structured
  CHEXPERT_CSV: validate.csv
  CHEXPERT_IMAGE_DIR: valid
  CHEXPERT_PATH: /Users/admin/Working/Data/MixData/nih_14_structured
  LABELS_LIST: ['Atelectasis', 'Cardiomegaly', 'Consolidation', 'Pleural Effusion', 'Pneumothorax']
  NAME: CXR
  NIH14_CSV: validate_reordered.csv
  NIH14_IMAGE_DIR: images
  NIH14_PATH: /home/ngoto/Working/Data/MixData/nih_14_structured
  PADCHEST_CSV: refined_padchest_labels_reordered.csv
  PADCHEST_IMAGE_DIR: images-224
  PADCHEST_PATH: /home/ngoto/Working/Data/MixData/PadChestPruning
  SEVERITY: 5.0
  TEST_CORRUPTIONS: ['elastic_transform', 'contrast', 'snow', 'pixelate', 'defocus_blur', 'motion_blur', 'zoom_blur', 'brightness', 'gaussian_noise', 'jpeg_compression', 'glass_blur', 'shot_noise', 'fog', 'frost', 'impulse_noise']
  TEST_DOMAINS: ['nih14']
  VINDR_CSV: validate_reordered.csv
  VINDR_IMAGE_DIR: images
  VINDR_PATH: /home/ngoto/Working/Data/MixData/vinbigdata_structured
DATA_DIR: ./datasets
DEBUG: 0
DESC: 
INPUT:
  INTERPOLATION: bilinear
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 2.225]
  SIZE: (224, 224)
  TRANSFORMS: ('normalize',)
LOADER:
  NUM_WORKS: 4
  SAMPLER:
    GAMMA: 0.1
    TYPE: temporal
LOG_DEST: log.txt
LOG_TIME: 
MODEL:
  ARCH: resnet18
  EPISODIC: False
  NUM_CLASSES: 5
  PROJECTION:
    EMB_DIM: 2048
    FEA_DIM: 128
    HEAD: linear
OPTIM:
  AP: 0.72
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  MT: 0.999
  NESTEROV: True
  RST: 0.01
  STEPS: 1
  WD: 0.0
OUTPUT_DIR: Log/RoTTA
SEED: 42
TEST:
  BATCH_SIZE: 64
  NUM_EPOCHS: 1
2025-08-19 23:29:42,715 TTA-ML INFO: Model and TTA adapter initialized.
2025-08-19 23:29:42,715 TTA-ML INFO: =========== Starting TTA Epoch 1/1 ===========
2025-08-19 23:29:42,716 TTA-ML INFO: Running in 'corruption' adaptation mode for this epoch.
2025-08-19 23:38:10,535 TTA-ML INFO: Namespace(config_file='configs/adapter/rotta.yaml', opts=[])
2025-08-19 23:38:10,536 TTA-ML INFO: Loaded configuration file: configs/adapter/rotta.yaml
2025-08-19 23:38:10,536 TTA-ML INFO: Running with config:
ADAPTER:
  NAME: rotta_multilabels
  RoTTA:
    ALPHA: 0.05
    LAMBDA_T: 1.0
    LAMBDA_U: 1.0
    MEMORY_SIZE: 64
    NU: 0.001
    UPDATE_FREQUENCY: 64
BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar10
  NUM_CLASS: -1
  NUM_EX: 10000
  SEVERITY: [5, 4, 3, 2, 1]
  SOURCE: 
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATASET:
  ADAPTATION_MODE: corruption
  BASE_DOMAIN:
    CSV: validate_reordered.csv
    IMAGE_DIR: images
    PATH: /home/ngoto/Working/Data/MixData/nih_14_structured
  CHEXPERT_CSV: validate.csv
  CHEXPERT_IMAGE_DIR: valid
  CHEXPERT_PATH: /Users/admin/Working/Data/MixData/nih_14_structured
  LABELS_LIST: ['Atelectasis', 'Cardiomegaly', 'Consolidation', 'Pleural Effusion', 'Pneumothorax']
  NAME: CXR
  NIH14_CSV: validate_reordered.csv
  NIH14_IMAGE_DIR: images
  NIH14_PATH: /home/ngoto/Working/Data/MixData/nih_14_structured
  PADCHEST_CSV: refined_padchest_labels_reordered.csv
  PADCHEST_IMAGE_DIR: images-224
  PADCHEST_PATH: /home/ngoto/Working/Data/MixData/PadChestPruning
  SEVERITY: 5.0
  TEST_CORRUPTIONS: ['elastic_transform', 'contrast', 'snow', 'pixelate', 'defocus_blur', 'motion_blur', 'zoom_blur', 'brightness', 'gaussian_noise', 'jpeg_compression', 'glass_blur', 'shot_noise', 'fog', 'frost', 'impulse_noise']
  TEST_DOMAINS: ['nih14']
  VINDR_CSV: validate_reordered.csv
  VINDR_IMAGE_DIR: images
  VINDR_PATH: /home/ngoto/Working/Data/MixData/vinbigdata_structured
DATA_DIR: ./datasets
DEBUG: 0
DESC: 
INPUT:
  INTERPOLATION: bilinear
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 2.225]
  SIZE: (224, 224)
  TRANSFORMS: ('normalize',)
LOADER:
  NUM_WORKS: 4
  SAMPLER:
    GAMMA: 0.1
    TYPE: temporal
LOG_DEST: log.txt
LOG_TIME: 
MODEL:
  ARCH: resnet18
  EPISODIC: False
  NUM_CLASSES: 5
  PROJECTION:
    EMB_DIM: 2048
    FEA_DIM: 128
    HEAD: linear
OPTIM:
  AP: 0.72
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  MT: 0.999
  NESTEROV: True
  RST: 0.01
  STEPS: 1
  WD: 0.0
OUTPUT_DIR: Log/RoTTA
SEED: 42
TEST:
  BATCH_SIZE: 64
  NUM_EPOCHS: 1
2025-08-19 23:38:13,297 TTA-ML INFO: Model and TTA adapter initialized.
2025-08-19 23:38:13,297 TTA-ML INFO: =========== Starting TTA Epoch 1/1 ===========
2025-08-19 23:38:13,298 TTA-ML INFO: Running in 'corruption' adaptation mode for this epoch.
2025-08-19 23:47:54,101 TTA-ML INFO: --- Epoch 1 Final Results ---
- Mean AUC: 0.6365
- Atelectasis      : 0.5947
- Cardiomegaly     : 0.6850
- Consolidation    : 0.5645
- Pleural Effusion : 0.6899
- Pneumothorax     : 0.6487
2025-08-19 23:47:54,127 TTA-ML INFO: New best AUC found: 0.6365. Saving model state for epoch 1.
2025-08-19 23:47:54,128 TTA-ML INFO: =========== TTA Finished ===========
2025-08-19 23:47:54,128 TTA-ML INFO: Best Mean AUC achieved across 1 epochs: 0.6365
2025-08-19 23:47:54,252 TTA-ML INFO: Best model state saved to Log/RoTTA/best_tta_model.pth
2025-08-19 23:49:44,147 TTA-ML INFO: Namespace(config_file='configs/adapter/rotta.yaml', opts=[])
2025-08-19 23:49:44,147 TTA-ML INFO: Loaded configuration file: configs/adapter/rotta.yaml
2025-08-19 23:49:44,147 TTA-ML INFO: Running with config:
ADAPTER:
  NAME: rotta_multilabels
  RoTTA:
    ALPHA: 0.05
    LAMBDA_T: 1.0
    LAMBDA_U: 1.0
    MEMORY_SIZE: 64
    NU: 0.001
    UPDATE_FREQUENCY: 64
BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar10
  NUM_CLASS: -1
  NUM_EX: 10000
  SEVERITY: [5, 4, 3, 2, 1]
  SOURCE: 
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATASET:
  ADAPTATION_MODE: corruption
  BASE_DOMAIN:
    CSV: validate_reordered.csv
    IMAGE_DIR: images
    PATH: /home/ngoto/Working/Data/MixData/nih_14_structured
  CHEXPERT_CSV: validate.csv
  CHEXPERT_IMAGE_DIR: valid
  CHEXPERT_PATH: /Users/admin/Working/Data/MixData/nih_14_structured
  LABELS_LIST: ['Atelectasis', 'Cardiomegaly', 'Consolidation', 'Pleural Effusion', 'Pneumothorax']
  NAME: CXR
  NIH14_CSV: validate_reordered.csv
  NIH14_IMAGE_DIR: images
  NIH14_PATH: /home/ngoto/Working/Data/MixData/nih_14_structured
  PADCHEST_CSV: refined_padchest_labels_reordered.csv
  PADCHEST_IMAGE_DIR: images-224
  PADCHEST_PATH: /home/ngoto/Working/Data/MixData/PadChestPruning
  SEVERITY: 5.0
  TEST_CORRUPTIONS: ['elastic_transform', 'contrast', 'snow', 'pixelate', 'defocus_blur', 'motion_blur', 'zoom_blur', 'brightness', 'gaussian_noise', 'jpeg_compression', 'glass_blur', 'shot_noise', 'fog', 'frost', 'impulse_noise']
  TEST_DOMAINS: ['nih14']
  VINDR_CSV: validate_reordered.csv
  VINDR_IMAGE_DIR: images
  VINDR_PATH: /home/ngoto/Working/Data/MixData/vinbigdata_structured
DATA_DIR: ./datasets
DEBUG: 0
DESC: 
INPUT:
  INTERPOLATION: bilinear
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 2.225]
  SIZE: (224, 224)
  TRANSFORMS: ('normalize',)
LOADER:
  NUM_WORKS: 4
  SAMPLER:
    GAMMA: 0.1
    TYPE: temporal
LOG_DEST: log.txt
LOG_TIME: 
MODEL:
  ARCH: resnet18
  EPISODIC: False
  NUM_CLASSES: 5
  PROJECTION:
    EMB_DIM: 2048
    FEA_DIM: 128
    HEAD: linear
OPTIM:
  AP: 0.72
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  MT: 0.999
  NESTEROV: True
  RST: 0.01
  STEPS: 1
  WD: 0.0
OUTPUT_DIR: Log/RoTTA
SEED: 42
TEST:
  BATCH_SIZE: 64
  NUM_EPOCHS: 1
2025-08-19 23:49:46,852 TTA-ML INFO: Model and TTA adapter initialized.
2025-08-19 23:49:46,852 TTA-ML INFO: =========== Starting TTA Epoch 1/1 ===========
2025-08-19 23:49:46,852 TTA-ML INFO: Running in 'corruption' adaptation mode for this epoch.
2025-08-19 23:59:42,093 TTA-ML INFO: --- Epoch 1 Final Results ---
- Mean AUC: 0.6371
- Atelectasis      : 0.5973
- Cardiomegaly     : 0.6837
- Consolidation    : 0.5663
- Pleural Effusion : 0.6892
- Pneumothorax     : 0.6490
2025-08-19 23:59:42,118 TTA-ML INFO: New best AUC found: 0.6371. Saving model state for epoch 1.
2025-08-19 23:59:42,119 TTA-ML INFO: =========== TTA Finished ===========
2025-08-19 23:59:42,119 TTA-ML INFO: Best Mean AUC achieved across 1 epochs: 0.6371
2025-08-19 23:59:42,347 TTA-ML INFO: Best model state saved to Log/RoTTA/best_tta_model.pth
2025-08-21 20:07:41,856 TTA-ML INFO: Namespace(config_file='configs/adapter/rotta.yaml', opts=[])
2025-08-21 20:07:41,856 TTA-ML INFO: Loaded configuration file: configs/adapter/rotta.yaml
2025-08-21 20:07:41,857 TTA-ML INFO: Running with config:
ADAPTER:
  NAME: rotta_multilabels
  RoTTA:
    ALPHA: 0.05
    LAMBDA_T: 1.0
    LAMBDA_U: 1.0
    MEMORY_SIZE: 64
    NU: 0.001
    UPDATE_FREQUENCY: 64
BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar10
  NUM_CLASS: -1
  NUM_EX: 10000
  SEVERITY: [5, 4, 3, 2, 1]
  SOURCE: 
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATASET:
  ADAPTATION_MODE: corruption
  BASE_DOMAIN:
    CSV: validate_reordered.csv
    IMAGE_DIR: images
    PATH: /home/ngoto/Working/Data/MixData/nih_14_structured
  CHEXPERT_CSV: validate.csv
  CHEXPERT_IMAGE_DIR: valid
  CHEXPERT_PATH: /Users/admin/Working/Data/MixData/nih_14_structured
  LABELS_LIST: ['Atelectasis', 'Cardiomegaly', 'Consolidation', 'Pleural Effusion', 'Pneumothorax']
  NAME: CXR
  NIH14_CSV: validate_reordered.csv
  NIH14_IMAGE_DIR: images
  NIH14_PATH: /home/ngoto/Working/Data/MixData/nih_14_structured
  PADCHEST_CSV: refined_padchest_labels_reordered.csv
  PADCHEST_IMAGE_DIR: images-224
  PADCHEST_PATH: /home/ngoto/Working/Data/MixData/PadChestPruning
  SEVERITY: 5.0
  TEST_CORRUPTIONS: ['elastic_transform', 'contrast', 'snow', 'pixelate', 'defocus_blur', 'motion_blur', 'zoom_blur', 'brightness', 'gaussian_noise', 'jpeg_compression', 'glass_blur', 'shot_noise', 'fog', 'frost', 'impulse_noise']
  TEST_DOMAINS: ['nih14']
  VINDR_CSV: validate_reordered.csv
  VINDR_IMAGE_DIR: images
  VINDR_PATH: /home/ngoto/Working/Data/MixData/vinbigdata_structured
DATA_DIR: ./datasets
DEBUG: 0
DESC: 
INPUT:
  INTERPOLATION: bilinear
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 2.225]
  SIZE: (224, 224)
  TRANSFORMS: ('normalize',)
LOADER:
  NUM_WORKS: 4
  SAMPLER:
    GAMMA: 0.1
    TYPE: temporal
LOG_DEST: log.txt
LOG_TIME: 
MODEL:
  ARCH: resnet18
  EPISODIC: False
  NUM_CLASSES: 5
  PROJECTION:
    EMB_DIM: 2048
    FEA_DIM: 128
    HEAD: linear
OPTIM:
  AP: 0.72
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  MT: 0.999
  NESTEROV: True
  RST: 0.01
  STEPS: 1
  WD: 0.0
OUTPUT_DIR: Log/RoTTA
SEED: 42
TEST:
  BATCH_SIZE: 64
  NUM_EPOCHS: 1
2025-08-21 20:07:44,885 TTA-ML INFO: Model and TTA adapter initialized.
2025-08-21 20:07:44,885 TTA-ML INFO: =========== Starting TTA Epoch 1/1 ===========
2025-08-21 20:07:44,886 TTA-ML INFO: Running in 'corruption' adaptation mode for this epoch.
2025-08-21 22:15:41,639 TTA-ML INFO: Namespace(config_file='configs/adapter/rotta.yaml', opts=[])
2025-08-21 22:15:41,639 TTA-ML INFO: Loaded configuration file: configs/adapter/rotta.yaml
2025-08-21 22:15:41,639 TTA-ML INFO: Running with config:
ADAPTER:
  NAME: rotta_multilabels
  RoTTA:
    ALPHA: 0.05
    LAMBDA_T: 1.0
    LAMBDA_U: 1.0
    MEMORY_SIZE: 64
    NU: 0.001
    UPDATE_FREQUENCY: 64
BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar10
  NUM_CLASS: -1
  NUM_EX: 10000
  SEVERITY: [5, 4, 3, 2, 1]
  SOURCE: 
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATASET:
  ADAPTATION_MODE: corruption
  BASE_DOMAIN:
    CSV: validate_reordered.csv
    IMAGE_DIR: images
    PATH: /home/ngoto/Working/Data/MixData/nih_14_structured
  CHEXPERT_CSV: validate.csv
  CHEXPERT_IMAGE_DIR: valid
  CHEXPERT_PATH: /Users/admin/Working/Data/MixData/nih_14_structured
  LABELS_LIST: ['Atelectasis', 'Cardiomegaly', 'Consolidation', 'Pleural Effusion', 'Pneumothorax']
  NAME: CXR
  NIH14_CSV: validate_reordered.csv
  NIH14_IMAGE_DIR: images
  NIH14_PATH: /home/ngoto/Working/Data/MixData/nih_14_structured
  PADCHEST_CSV: refined_padchest_labels_reordered.csv
  PADCHEST_IMAGE_DIR: images-224
  PADCHEST_PATH: /home/ngoto/Working/Data/MixData/PadChestPruning
  SEVERITY: 5.0
  TEST_CORRUPTIONS: ['elastic_transform', 'contrast', 'snow', 'pixelate', 'defocus_blur', 'motion_blur', 'zoom_blur', 'brightness', 'gaussian_noise', 'jpeg_compression', 'glass_blur', 'shot_noise', 'fog', 'frost', 'impulse_noise']
  TEST_DOMAINS: ['nih14']
  VINDR_CSV: validate_reordered.csv
  VINDR_IMAGE_DIR: images
  VINDR_PATH: /home/ngoto/Working/Data/MixData/vinbigdata_structured
DATA_DIR: ./datasets
DEBUG: 0
DESC: 
INPUT:
  INTERPOLATION: bilinear
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 2.225]
  SIZE: (224, 224)
  TRANSFORMS: ('normalize',)
LOADER:
  NUM_WORKS: 4
  SAMPLER:
    GAMMA: 0.1
    TYPE: temporal
LOG_DEST: log.txt
LOG_TIME: 
MODEL:
  ARCH: resnet18
  EPISODIC: False
  NUM_CLASSES: 5
  PROJECTION:
    EMB_DIM: 2048
    FEA_DIM: 128
    HEAD: linear
OPTIM:
  AP: 0.72
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  MT: 0.999
  NESTEROV: True
  RST: 0.01
  STEPS: 1
  WD: 0.0
OUTPUT_DIR: Log/RoTTA
SEED: 42
TEST:
  BATCH_SIZE: 64
  NUM_EPOCHS: 1
2025-08-21 22:15:44,581 TTA-ML INFO: Model and TTA adapter initialized.
2025-08-21 22:15:44,582 TTA-ML INFO: =========== Starting TTA Epoch 1/1 ===========
2025-08-21 22:15:44,582 TTA-ML INFO: Running in 'corruption' adaptation mode for this epoch.
2025-08-22 11:49:25,333 TTA-ML INFO: Namespace(config_file='configs/adapter/rotta.yaml', opts=[])
2025-08-22 11:49:25,333 TTA-ML INFO: Loaded configuration file: configs/adapter/rotta.yaml
2025-08-22 11:49:25,333 TTA-ML INFO: Running with config:
ADAPTER:
  NAME: rotta_multilabels
  RoTTA:
    ALPHA: 0.05
    LAMBDA_T: 1.0
    LAMBDA_U: 1.0
    MEMORY_SIZE: 64
    NU: 0.001
    UPDATE_FREQUENCY: 64
BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar10
  NUM_CLASS: -1
  NUM_EX: 10000
  SEVERITY: [5, 4, 3, 2, 1]
  SOURCE: 
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATASET:
  ADAPTATION_MODE: corruption
  BASE_DOMAIN:
    CSV: validate_reordered.csv
    IMAGE_DIR: images
    PATH: /home/ngoto/Working/Data/MixData/nih_14_structured
  CHEXPERT_CSV: validate.csv
  CHEXPERT_IMAGE_DIR: valid
  CHEXPERT_PATH: /Users/admin/Working/Data/MixData/nih_14_structured
  LABELS_LIST: ['Atelectasis', 'Cardiomegaly', 'Consolidation', 'Pleural Effusion', 'Pneumothorax']
  NAME: CXR
  NIH14_CSV: validate_reordered.csv
  NIH14_IMAGE_DIR: images
  NIH14_PATH: /home/ngoto/Working/Data/MixData/nih_14_structured
  PADCHEST_CSV: refined_padchest_labels_reordered.csv
  PADCHEST_IMAGE_DIR: images-224
  PADCHEST_PATH: /home/ngoto/Working/Data/MixData/PadChestPruning
  SEVERITY: 5.0
  TEST_CORRUPTIONS: ['elastic_transform', 'contrast', 'snow', 'pixelate', 'defocus_blur', 'motion_blur', 'zoom_blur', 'brightness', 'gaussian_noise', 'jpeg_compression', 'glass_blur', 'shot_noise', 'fog', 'frost', 'impulse_noise']
  TEST_DOMAINS: ['nih14']
  VINDR_CSV: validate_reordered.csv
  VINDR_IMAGE_DIR: images
  VINDR_PATH: /home/ngoto/Working/Data/MixData/vinbigdata_structured
DATA_DIR: ./datasets
DEBUG: 0
DESC: 
INPUT:
  INTERPOLATION: bilinear
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 2.225]
  SIZE: (224, 224)
  TRANSFORMS: ('normalize',)
LOADER:
  NUM_WORKS: 4
  SAMPLER:
    GAMMA: 0.1
    TYPE: temporal
LOG_DEST: log.txt
LOG_TIME: 
MODEL:
  ARCH: resnet18
  EPISODIC: False
  NUM_CLASSES: 5
  PROJECTION:
    EMB_DIM: 2048
    FEA_DIM: 128
    HEAD: linear
OPTIM:
  AP: 0.72
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  MT: 0.999
  NESTEROV: True
  RST: 0.01
  STEPS: 1
  WD: 0.0
OUTPUT_DIR: Log/RoTTA
SEED: 42
TEST:
  BATCH_SIZE: 64
  NUM_EPOCHS: 1
2025-08-22 11:49:28,449 TTA-ML INFO: Model and TTA adapter initialized.
2025-08-22 11:49:28,450 TTA-ML INFO: =========== Starting TTA Epoch 1/1 ===========
2025-08-22 11:49:28,450 TTA-ML INFO: Running in 'corruption' adaptation mode for this epoch.
2025-08-22 11:58:18,370 TTA-ML INFO: =========== TTA Finished ===========
2025-08-22 11:58:18,370 TTA-ML INFO: Best Mean AUC achieved across 1 epochs: 0.0000
2025-08-22 12:01:29,809 TTA-ML INFO: Namespace(config_file='configs/adapter/rotta.yaml', opts=[])
2025-08-22 12:01:29,809 TTA-ML INFO: Loaded configuration file: configs/adapter/rotta.yaml
2025-08-22 12:01:29,809 TTA-ML INFO: Running with config:
ADAPTER:
  NAME: rotta_multilabels
  RoTTA:
    ALPHA: 0.05
    LAMBDA_T: 1.0
    LAMBDA_U: 1.0
    MEMORY_SIZE: 64
    NU: 0.001
    UPDATE_FREQUENCY: 64
BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar10
  NUM_CLASS: -1
  NUM_EX: 10000
  SEVERITY: [5, 4, 3, 2, 1]
  SOURCE: 
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATASET:
  ADAPTATION_MODE: corruption
  BASE_DOMAIN:
    CSV: validate_reordered.csv
    IMAGE_DIR: images
    PATH: /home/ngoto/Working/Data/MixData/nih_14_structured
  CHEXPERT_CSV: validate.csv
  CHEXPERT_IMAGE_DIR: valid
  CHEXPERT_PATH: /Users/admin/Working/Data/MixData/nih_14_structured
  LABELS_LIST: ['Atelectasis', 'Cardiomegaly', 'Consolidation', 'Pleural Effusion', 'Pneumothorax']
  NAME: CXR
  NIH14_CSV: validate_reordered.csv
  NIH14_IMAGE_DIR: images
  NIH14_PATH: /home/ngoto/Working/Data/MixData/nih_14_structured
  PADCHEST_CSV: refined_padchest_labels_reordered.csv
  PADCHEST_IMAGE_DIR: images-224
  PADCHEST_PATH: /home/ngoto/Working/Data/MixData/PadChestPruning
  SEVERITY: 5.0
  TEST_CORRUPTIONS: ['elastic_transform', 'contrast', 'snow', 'pixelate', 'defocus_blur', 'motion_blur', 'zoom_blur', 'brightness', 'gaussian_noise', 'jpeg_compression', 'glass_blur', 'shot_noise', 'fog', 'frost', 'impulse_noise']
  TEST_DOMAINS: ['nih14']
  VINDR_CSV: validate_reordered.csv
  VINDR_IMAGE_DIR: images
  VINDR_PATH: /home/ngoto/Working/Data/MixData/vinbigdata_structured
DATA_DIR: ./datasets
DEBUG: 0
DESC: 
INPUT:
  INTERPOLATION: bilinear
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 2.225]
  SIZE: (224, 224)
  TRANSFORMS: ('normalize',)
LOADER:
  NUM_WORKS: 4
  SAMPLER:
    GAMMA: 0.1
    TYPE: temporal
LOG_DEST: log.txt
LOG_TIME: 
MODEL:
  ARCH: resnet18
  EPISODIC: False
  NUM_CLASSES: 5
  PROJECTION:
    EMB_DIM: 2048
    FEA_DIM: 128
    HEAD: linear
OPTIM:
  AP: 0.72
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  MT: 0.999
  NESTEROV: True
  RST: 0.01
  STEPS: 1
  WD: 0.0
OUTPUT_DIR: Log/RoTTA
SEED: 42
TEST:
  BATCH_SIZE: 64
  NUM_EPOCHS: 1
2025-08-22 12:01:32,893 TTA-ML INFO: Model and TTA adapter initialized.
2025-08-22 12:01:32,893 TTA-ML INFO: =========== Starting TTA Epoch 1/1 ===========
2025-08-22 12:01:32,893 TTA-ML INFO: Running in 'corruption' adaptation mode for this epoch.
2025-08-22 12:10:39,858 TTA-ML INFO: =========== TTA Finished ===========
2025-08-22 12:10:39,859 TTA-ML INFO: Best Mean AUC achieved across 1 epochs: 0.0000
2025-09-06 22:28:06,356 TTA-ML INFO: Namespace(config_file='configs/adapter/rotta.yaml', opts=[])
2025-09-06 22:28:06,356 TTA-ML INFO: Loaded configuration file: configs/adapter/rotta.yaml
2025-09-06 22:28:06,356 TTA-ML INFO: Running with config:
ADAPTER:
  NAME: rotta_multilabels
  RoTTA:
    ALPHA: 0.05
    LAMBDA_T: 1.0
    LAMBDA_U: 1.0
    MEMORY_SIZE: 64
    NU: 0.001
    UPDATE_FREQUENCY: 64
BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar10
  NUM_CLASS: -1
  NUM_EX: 10000
  SEVERITY: [5, 4, 3, 2, 1]
  SOURCE: 
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATASET:
  ADAPTATION_MODE: corruption
  BASE_DOMAIN:
    CSV: validate_reordered.csv
    IMAGE_DIR: images
    PATH: /home/ngoto/Working/Data/MixData/nih_14_structured
  CHEXPERT_CSV: validate.csv
  CHEXPERT_IMAGE_DIR: valid
  CHEXPERT_PATH: /Users/admin/Working/Data/MixData/nih_14_structured
  LABELS_LIST: ['Atelectasis', 'Cardiomegaly', 'Consolidation', 'Pleural Effusion', 'Pneumothorax']
  NAME: CXR
  NIH14_CSV: validate_reordered.csv
  NIH14_IMAGE_DIR: images
  NIH14_PATH: /home/ngoto/Working/Data/MixData/nih_14_structured
  PADCHEST_CSV: refined_padchest_labels_reordered.csv
  PADCHEST_IMAGE_DIR: images-224
  PADCHEST_PATH: /home/ngoto/Working/Data/MixData/PadChestPruning
  SEVERITY: 5.0
  TEST_CORRUPTIONS: None
  TEST_DOMAINS: ['nih14']
  VINDR_CSV: validate_reordered.csv
  VINDR_IMAGE_DIR: images
  VINDR_PATH: /home/ngoto/Working/Data/MixData/vinbigdata_structured
DATA_DIR: ./datasets
DEBUG: 0
DESC: 
INPUT:
  INTERPOLATION: bilinear
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 2.225]
  SIZE: (224, 224)
  TRANSFORMS: ('normalize',)
LOADER:
  NUM_WORKS: 4
  SAMPLER:
    GAMMA: 0.1
    TYPE: temporal
LOG_DEST: log.txt
LOG_TIME: 
MODEL:
  ARCH: mobilenet_v3_small
  EPISODIC: False
  NUM_CLASSES: 5
  PROJECTION:
    EMB_DIM: 2048
    FEA_DIM: 128
    HEAD: linear
OPTIM:
  AP: 0.72
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  MT: 0.999
  NESTEROV: True
  RST: 0.01
  STEPS: 1
  WD: 0.0
OUTPUT_DIR: Log/RoTTA
SEED: 42
TEST:
  BATCH_SIZE: 64
  NUM_EPOCHS: 1
2025-09-06 22:28:08,971 TTA-ML INFO: Model and TTA adapter initialized.
2025-09-06 22:28:08,972 TTA-ML INFO: =========== Starting TTA Epoch 1/1 ===========
2025-09-06 22:28:08,972 TTA-ML INFO: Running in 'corruption' adaptation mode for this epoch.
2025-09-06 23:07:23,624 TTA-ML INFO: Namespace(config_file='configs/adapter/rotta.yaml', opts=[])
2025-09-06 23:07:23,625 TTA-ML INFO: Loaded configuration file: configs/adapter/rotta.yaml
2025-09-06 23:07:23,625 TTA-ML INFO: Running with config:
ADAPTER:
  NAME: rotta_multilabels
  RoTTA:
    ALPHA: 0.05
    LAMBDA_T: 1.0
    LAMBDA_U: 1.0
    MEMORY_SIZE: 64
    NU: 0.001
    UPDATE_FREQUENCY: 64
BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar10
  NUM_CLASS: -1
  NUM_EX: 10000
  SEVERITY: [5, 4, 3, 2, 1]
  SOURCE: 
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATASET:
  ADAPTATION_MODE: corruption
  BASE_DOMAIN:
    CSV: validate_reordered.csv
    IMAGE_DIR: images
    PATH: /home/ngoto/Working/Data/MixData/nih_14_structured
  CHEXPERT_CSV: validate.csv
  CHEXPERT_IMAGE_DIR: valid
  CHEXPERT_PATH: /Users/admin/Working/Data/MixData/nih_14_structured
  LABELS_LIST: ['Atelectasis', 'Cardiomegaly', 'Consolidation', 'Pleural Effusion', 'Pneumothorax']
  NAME: CXR
  NIH14_CSV: validate_reordered.csv
  NIH14_IMAGE_DIR: images
  NIH14_PATH: /home/ngoto/Working/Data/MixData/nih_14_structured
  PADCHEST_CSV: refined_padchest_labels_reordered.csv
  PADCHEST_IMAGE_DIR: images-224
  PADCHEST_PATH: /home/ngoto/Working/Data/MixData/PadChestPruning
  SEVERITY: 5.0
  TEST_CORRUPTIONS: ['elastic_transform', 'contrast', 'brightness', 'gaussian_noise', 'shot_noise', 'impulse_noise']
  TEST_DOMAINS: ['nih14']
  VINDR_CSV: validate_reordered.csv
  VINDR_IMAGE_DIR: images
  VINDR_PATH: /home/ngoto/Working/Data/MixData/vinbigdata_structured
DATA_DIR: ./datasets
DEBUG: 0
DESC: 
INPUT:
  INTERPOLATION: bilinear
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 2.225]
  SIZE: (224, 224)
  TRANSFORMS: ('normalize',)
LOADER:
  NUM_WORKS: 4
  SAMPLER:
    GAMMA: 0.1
    TYPE: temporal
LOG_DEST: log.txt
LOG_TIME: 
MODEL:
  ARCH: mobilenet_v3_small
  EPISODIC: False
  NUM_CLASSES: 5
  PROJECTION:
    EMB_DIM: 2048
    FEA_DIM: 128
    HEAD: linear
OPTIM:
  AP: 0.72
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  MT: 0.999
  NESTEROV: True
  RST: 0.01
  STEPS: 1
  WD: 0.0
OUTPUT_DIR: Log/RoTTA
SEED: 42
TEST:
  BATCH_SIZE: 64
  NUM_EPOCHS: 1
2025-09-06 23:07:26,163 TTA-ML INFO: Model and TTA adapter initialized.
2025-09-06 23:07:26,164 TTA-ML INFO: =========== Starting TTA Epoch 1/1 ===========
2025-09-06 23:07:26,164 TTA-ML INFO: Running in 'corruption' adaptation mode for this epoch.
2025-09-06 23:40:00,112 TTA-ML INFO: Namespace(config_file='configs/adapter/rotta.yaml', opts=[])
2025-09-06 23:40:00,112 TTA-ML INFO: Loaded configuration file: configs/adapter/rotta.yaml
2025-09-06 23:40:00,113 TTA-ML INFO: Running with config:
ADAPTER:
  NAME: rotta_multilabels
  RoTTA:
    ALPHA: 0.05
    LAMBDA_T: 1.0
    LAMBDA_U: 1.0
    MEMORY_SIZE: 64
    NU: 0.001
    UPDATE_FREQUENCY: 64
BN:
  EPS: 1e-05
  MOM: 0.1
CKPT_DIR: ./ckpt
CORRUPTION:
  DATASET: cifar10
  NUM_CLASS: -1
  NUM_EX: 10000
  SEVERITY: [5, 4, 3, 2, 1]
  SOURCE: 
  TYPE: ['gaussian_noise', 'shot_noise', 'impulse_noise', 'defocus_blur', 'glass_blur', 'motion_blur', 'zoom_blur', 'snow', 'frost', 'fog', 'brightness', 'contrast', 'elastic_transform', 'pixelate', 'jpeg_compression']
CUDNN:
  BENCHMARK: True
DATASET:
  ADAPTATION_MODE: corruption
  BASE_DOMAIN:
    CSV: validate_reordered.csv
    IMAGE_DIR: images
    PATH: /home/ngoto/Working/Data/MixData/nih_14_structured
  CHEXPERT_CSV: validate.csv
  CHEXPERT_IMAGE_DIR: valid
  CHEXPERT_PATH: /Users/admin/Working/Data/MixData/nih_14_structured
  LABELS_LIST: ['Atelectasis', 'Cardiomegaly', 'Consolidation', 'Pleural Effusion', 'Pneumothorax']
  NAME: CXR
  NIH14_CSV: validate_reordered.csv
  NIH14_IMAGE_DIR: images
  NIH14_PATH: /home/ngoto/Working/Data/MixData/nih_14_structured
  PADCHEST_CSV: refined_padchest_labels_reordered.csv
  PADCHEST_IMAGE_DIR: images-224
  PADCHEST_PATH: /home/ngoto/Working/Data/MixData/PadChestPruning
  SEVERITY: 5.0
  TEST_CORRUPTIONS: ['elastic_transform', 'contrast', 'brightness', 'gaussian_noise', 'shot_noise', 'impulse_noise']
  TEST_DOMAINS: ['nih14']
  VINDR_CSV: validate_reordered.csv
  VINDR_IMAGE_DIR: images
  VINDR_PATH: /home/ngoto/Working/Data/MixData/vinbigdata_structured
DATA_DIR: ./datasets
DEBUG: 0
DESC: 
INPUT:
  INTERPOLATION: bilinear
  PIXEL_MEAN: [0.485, 0.456, 0.406]
  PIXEL_STD: [0.229, 0.224, 2.225]
  SIZE: (224, 224)
  TRANSFORMS: ('normalize',)
LOADER:
  NUM_WORKS: 4
  SAMPLER:
    GAMMA: 0.1
    TYPE: temporal
LOG_DEST: log.txt
LOG_TIME: 
MODEL:
  ARCH: mobilenet_v3_small
  EPISODIC: False
  NUM_CLASSES: 5
  PROJECTION:
    EMB_DIM: 2048
    FEA_DIM: 128
    HEAD: linear
OPTIM:
  AP: 0.72
  BETA: 0.9
  DAMPENING: 0.0
  LR: 0.001
  METHOD: Adam
  MOMENTUM: 0.9
  MT: 0.999
  NESTEROV: True
  RST: 0.01
  STEPS: 1
  WD: 0.0
OUTPUT_DIR: Log/RoTTA
SEED: 42
TEST:
  BATCH_SIZE: 64
  NUM_EPOCHS: 1
2025-09-06 23:40:02,760 TTA-ML INFO: Model and TTA adapter initialized.
2025-09-06 23:40:02,761 TTA-ML INFO: =========== Starting TTA Epoch 1/1 ===========
2025-09-06 23:40:02,761 TTA-ML INFO: Running in 'corruption' adaptation mode for this epoch.
